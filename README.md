# LatentTopoDynamics

This repository contains the code for **"Learning Networked Dynamics from Time Series: Latent Graph ODEs Across Diverse Topologies."**

We propose a neural ODE framework that models continuous-time node dynamics without requiring access to known graph topology, and can generalize across unseen topological structures. Our experiments focus on six synthetic dynamical systems and a real-world COVID-19 forecasting task.


## Synthetic Systems

Synthetic experiments are generated by simulating continuous-time node dynamics over synthetic graph topologies using differential equations.

### Available Dynamics (in `data_generation/Dynamics/`)
Each Python file defines one system of coupled ODEs:
- `Epidemic.py` – SIS epidemic model
- `Popu.py` – Population flow
- `Gene.py` – Gene regulatory networks
- `Eco2.py` – Mutualistic ecosystems
- `Neural.py` – Wilson–Cowan neural dynamics
- `LV.py` – Lotka–Volterra ecological systems

Each system defines:
```math
dx_i/dt = f(x_i,θ) + \sum_j A_{ij} g(x_i,x_j,θ)
```
where `A_ij` is the adjacency matrix and θ are node-specific or global parameters.

### Topologies
You can select:
- `er`: Erdős–Rényi random graph
- `sf`: Scale-Free network (Barabási–Albert)  

### Generate Data
Use the following command:
```bash
python data_generation/run.py \
    --dynamics gene \
    --topology sf \
    --n 100 \
    --k 12 \
    --x0_out 1 \
    --s_out 0 \
    --k_out 0
```

- `--x0_out`: use out-of-distribution initial conditions
- `--s_out`: out-of-distribution edge weights
- `--k_out`: out-of-distribution network degree
- `--fix_dyn`: fix dynamics across nodes (or allow heterogeneity)

All generated time series are stored in `.npy` format and can be directly used for training with `run_models.py`.
 
 
### Run synthetic experiments

```bash
bash sample.sh
```

## Real Systems
To train and test on the COVID-19 dataset, run
```bash
python3 run_models_covid.py  
```
